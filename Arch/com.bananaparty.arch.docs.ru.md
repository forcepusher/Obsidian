# Архитектура "Спидран по контракту"
Поехали.
## Оглавление
Материал будет состоять из практических и философских частей.
- На философской части мы стабилизируем понимание слова "объект" и всего, что с ним связано, чтобы понять принятые решения и совершать меньше детских ошибок.
- На практике мы нырнём сразу в дело и сделаем с помощью пары скриптов то, ради чего нормисы обычно несут в Unity проект несколько фреймворков с граблями, на которые уже не смешно наступать в 20-й раз.
- Так же будет блок по авто тестированию проектов. Никто вам не выделит целый отдел тестировщиков. Не у всех есть бюджет, чтоб закидать проблему деньгами.
## TL;DR выжимки
Хороший код разраб пишет в первые 1-2 года своей карьеры. Затем только через 10-15 лет. Чем быстрей вы выйдите из середины, тем проще будет жить вам и всем окружающим, поэтому я постараюсь ускорить процесс трансформации.
![[linesperhourprogrammer.png]]
Пункты будут доработаны из TL;DR версии в полный трактат по запросу "пояснить за базар".
#### TL;DR: Спидран по философии объектов
- Представьте, что объект это самостоятельная консольная программа. Из неё нельзя просто так достать чё хочешь и вертеть как хочешь, у неё есть свой интерфейс командной строки (CLI) для общения с программой (например как у Git в терминале). В нашем случае интерфейсом являются публичные методы класса, либо явно заданный интерфейс.
  (Источник: [мой старый пост](https://forcepusher.tumblr.com/post/646953788143484928/my-take-on-explaining-oop-to-traditional))
- Объекты должны имплементировать одну фичу, S это не просто так первая буква в SOLID. Ещё объекты должны быть самодостаточными. По завершению исполнения конструктора, у объекта должны быть все необходимые данные и ссылки для исполнения своей задачи. В случае с Unity, конструктор это референсы/поля инспектора и Awake.
  (Источник: Robert Martin, Егор Бугаенко, и я со своим Unity)
- Объект состоит из поведения и состояния. Если где-то что-то происходит, значит есть и объект, который это делает. Не бывает поведения в вакууме. Так же и не бывает объектов, которые состоят из одних только данных или состояния - это скорей просто структура. Поэтому деление слоёв на Model, View и Controller (либо другой MV*) это ошибка дизайна.
  (Источники: [David West (Object Thinking)](https://www.youtube.com/watch?v=s-hdZZzMCac) и Егор Бугаенко)
- В правильном наименовании класса содержится 90% решения проблемы, это источник правильного мышления. Имя не должно быть излишне абстрактным, ненадо бояться точной конкретики. И не пытайтесь набить цену классу, продавая его умным названием. Если назвать дом хендлером жителей, то и делать будешь хендлер жителей, а не дом.
  В ту же помойку Manager, Controller, Handler, Presenter и т.п.
  (Источник: тоже я)
- Избегать названия объектов, образованных от глагола, оно должно оканчиваться существительным. Основной детектор ошибки это окончания -er. Например Loader, ну вот что за абстракции Загружатор, Расставлятор, Нагибатор? Объекты надо называть исходя из того что они содержат или чем по сути являются. Загружатор это название ни к чему не привязанного поведения. Найдите источник этого поведения и найдёте объект.
  (Гигачады: Егор Бугаенко, [Peter Coad](https://en.wikipedia.org/wiki/Peter_Coad), [Carlo Pescio](https://www.carlopescio.com/2011/04/your-coding-conventions-are-hurting-you.html), [Travis Griggs](https://objology.blogspot.com/2011/09/one-of-best-bits-of-programming-advice.html), и [Ben Hall](https://web.archive.org/web/20130116152533/https://www.benhallbenhall.com/2013/01/naming-objects-er-object-names/). Этот пункт больше всего придаётся бугурту, но слишком много великих мыслителей включая меня заметили эту проблему, поэтому вам придётся с этим жить)
#### TL;DR: Волшебные скрипты для архитектуры в Unity
Если философия выше непонятна - ничего страшного, у нас есть волшебные ~~бобы~~ скрипты.
Каждый из скриптов решает точечно одну проблему, и доставать их из мешочка мы будем только тогда, когда проблема физически материализуется, вместо того чтоб бежать впереди паровоза и городить какую-то бесполезную херню заранее, пытаясь предугадать все правки, требования паблишеров, и давление мочи в голове у гейм дизайнера.

Разберём типичные ситуации:
- Ситуация "Я хочу глобальные скрипты)))))0 а техлид говорит нельзя статику((((((((99".
#### TL;DR: Как выжить без толпы тестировщиков
